<HTML>
    <HEAD>
        <TITLE>ISI-MM-AUTHENTICATION DEMAND</TITLE>
        <SCRIPT SRC="../ISI_Util.js" language="JavaScript" type="text/JavaScript"></SCRIPT>
        <LINK href="../ISI_PDU_Generator.css" rel="stylesheet" type="text/css">
    </HEAD>
    <body marginwidth="0" marginheight="0" topmargin="0" leftmargin="0" style="" class="darkblue">        
        <form ID="Form1">
            <table ID="Table1">
                <col width="160"/>
                    <tr>                    
                        <th align="left">Security level at the calling user AI</th>
                        <td>
                            <select ID="Security_level_at_calling_user_ai">                          
	                            <option value="0" >No air interface encryption required
	                            <option value="1" >Air interface encryption required 1
	                            <option value="2" >Air interface encryption required 2
	                        </select>
                        </td>
                    </tr>
                    <tr>                    
                        <th align="left">Called Party</th>
                        <td>
                            SSI <input value="62033" size=3 ID="Called_Party_SSI" >                    
	                        MCC <input value="233" size=1 ID="Called_Party_MCC">
	                        MNC <input value="73" size=1 ID="Called_Party_MNC">
	                        External SN <input value="1234567890" size=10 ID="Called_Party_Ext">
                        </td>
                    </tr>
                    <tr>                    
                        <th align="left">Calling Party</th>
                        <td>
                            SSI <input value="62044" size=3 ID="Calling_Party_SSI">                    
	                        MCC <input value="244" size=1 ID="Calling_Party_MCC">
	                        MNC <input value="74" size=1 ID="Calling_Party_MNC">
	                        External SN <input value="0987654321" size=10 ID="Calling_Party_Ext" onChange="OnChange_Calling_Party_Ext(this.form)" >
                        </td>
                    </tr>
                    <tr>                    
                        <th align="left">MSISDN present as Ext SN</th>
                        <td>
                            <select ID="MSISDN_present_Ext_SN">                          
	                            <option value="0" >Does not correspond to an MSISDN
	                            <option value="1" >Corresponds to an MSISDN
	                        </select>
                        </td>
                    </tr>
                    <tr>                    
                        <th align="left">Numbering plan identification</th>
                        <td>
                            <select ID="Numbering_plan_identification">                          
	                            <option value="0" > Unknown
	                            <option selected value="1" > PSTN/ISDN/GSM
	                            <option value="2" > Reserved
	                            <option value="3" > Data Numbering Plan
	                            <option value="4" > Reserved (Telex)
	                            <option value="5" > Reserved
	                            <option value="6" > Reserved
	                            <option value="7" > Reserved
	                            <option value="8" > National standard numbering plan
	                            <option value="9" > Private numbering plan
	                            <option value="10"> Reserved for extension
	                            <option value="11"> Reserved for extension
	                            <option value="12"> Reserved for extension
	                            <option value="13"> Reserved for extension
	                            <option value="14"> Reserved for extension
	                            <option value="15"> Reserved for extension
	                        </select>
                        </td>
                    </tr>
                    <tr>                    
                        <th align="left">Type of number</th>
                        <td>
                            <select ID="Type_of_number">                          
	                            <option value="0" > Unknown/unknown
	                            <option selected value="1" > International number/level 2 regional number
	                            <option value="2" > National number/level 1 regional number
	                            <option value="3" > Network specific number/PISN specific number
	                            <option value="4" > Subscriber number/level 0 regional number
	                            <option value="5" > Reserved for extension
	                            <option value="6" > Reserved for extension
	                            <option value="7" > Reserved for extension
	                        </select>
                        </td>
                    </tr>
                    <tr>                    
                        <th align="left">Screening indicator</th>
                        <td>
                            <select ID="Screening_indicator">                          
	                            <option value="0" > User provided, not screened
	                            <option selected value="1" > User provided, verified and passed
	                            <option value="2" > User provided, verified and failed
	                            <option value="3" > Network provided
	                        </select>
                        </td>
                    </tr>
                    <tr>                    
                        <th align="left">ISISDS subtype</th>
                        <td>
                            <select ID="ISISDS_subtype" onChange="OnChange_ISISDS_subtype(this.form)" >                          
	                            <option value="0" > Predefined Status
	                            <option selected value="1" > SD type identifier
	                        </select>
                        </td>
                    </tr>
                    <tr>                    
                        <th align="left">Pre coded status</th>
                        <td>
                            <input disabled value="22" size=1 ID="Pre_coded_status">                    
                        </td>
                    </tr>
                    <tr>                    
                        <th align="left">Short data type id</th>
                        <td>
                            <select ID="Short_data_type_id" onChange="OnChange_Short_data_type_id(this.form)" >                          
	                            <option value="0" > Type 1
	                            <option value="1" > Type 2
	                            <option value="2" > Type 3
	                            <option selected value="3" > Type 4
	                        </select>
                        </td>
                    </tr>
                    <tr>                    
                        <th align="left">User defined data, Type 1..3</th>
                        <td>
                            <input value="44" size=3 ID="User_defined_data_1_3">                    
                        </td>
                    </tr>
                    <tr>                    
                        <th align="left">User defined data, Type 4</th>
                        <td>
                            <input value="Tetra ISI/SD PDU" size=20 ID="User_defined_data_4">                    
                        </td>
                    </tr>
                    <tr>                    
                        <th align="left">Hop count</th>
                        <td>
                            <select ID="Hop_count">                          
	                            <option value="0" > 0
	                            <option selected value="1" > 1
	                            <option value="2" > 2
	                            <option value="3" > 3
	                        </select>
                        </td>
                    </tr>
                    <th align="left">Selected area number</th>
                    <td>
                        <select onChange="OnEnableDisable_Ctrl(this.form.T2_Selected_area_number,this.form.Selected_area_number)" ID="T2_Selected_area_number">                          
	                        <option selected value="0">T2 Not Present
	                        <option value="1">T2 Present
	                    </select>
                        <input disabled id="Selected_area_number" value="33" size=4 >
                    </td>
            </table>
        </form>
        <script language="JavaScript" type="text/JavaScript">
    
            function GetPDUValue(pdu_header)
            {
                //Get Information Element values
                Security_level_at_calling_user_ai = document.getElementById('Security_level_at_calling_user_ai').value;      
                
                Called_Party_SSI = document.getElementById('Called_Party_SSI').value;      
                Called_Party_MCC = document.getElementById('Called_Party_MCC').value;      
                Called_Party_MNC = document.getElementById('Called_Party_MNC').value;      
                Called_Party_Ext = document.getElementById('Called_Party_Ext').value;      
                
                Calling_Party_SSI = document.getElementById('Calling_Party_SSI').value;      
                Calling_Party_MCC = document.getElementById('Calling_Party_MCC').value;      
                Calling_Party_MNC = document.getElementById('Calling_Party_MNC').value;      
                Calling_Party_Ext = document.getElementById('Calling_Party_Ext').value;   
                   
                MSISDN_present_Ext_SN               = document.getElementById('MSISDN_present_Ext_SN').value;      
                Numbering_plan_identification       = document.getElementById('Numbering_plan_identification').value;      
                Type_of_number                      = document.getElementById('Type_of_number').value;      
                Screening_indicator                 = document.getElementById('Screening_indicator').value;      
                ISISDS_subtype                      = document.getElementById('ISISDS_subtype').value;      
                Pre_coded_status                    = document.getElementById('Pre_coded_status').value;      
                Short_data_type_id                  = document.getElementById('Short_data_type_id').value;      
                User_defined_data_1_3               = document.getElementById('User_defined_data_1_3').value;      
                User_defined_data_4                 = document.getElementById('User_defined_data_4').value;      
                
                
                Hop_count                           = document.getElementById('Hop_count').value;      
                T2_Selected_area_number             = document.getElementById('T2_Selected_area_number').value;      
                Selected_area_number                = document.getElementById('Selected_area_number').value;      
                
                //Build PDU
                
                pdu_bin_value = pdu_header;
                T2_pdu_bin_value = "";

                pdu_bin_value += dec2bin(Security_level_at_calling_user_ai,2);
                
                pdu_bin_value += dec2bin(Called_Party_SSI,24);
                pdu_bin_value += dec2bin(Called_Party_MCC,10);
                pdu_bin_value += dec2bin(Called_Party_MNC,14);
                
                pdu_bin_value += dec2bin(Called_Party_Ext.length,5);
                
                ext_length = parseInt(Called_Party_Ext.length);
                if (ext_length > 0)
                    pdu_bin_value += digit2bin(Called_Party_Ext);
                
                pdu_bin_value += dec2bin(Calling_Party_SSI,24);
                pdu_bin_value += dec2bin(Calling_Party_MCC,10);
                pdu_bin_value += dec2bin(Calling_Party_MNC,14);
                
                pdu_bin_value += dec2bin(Calling_Party_Ext.length,5);
                
                ext_length = parseInt(Calling_Party_Ext.length);
                if (ext_length > 0)
                {
                    pdu_bin_value += digit2bin(Calling_Party_Ext);
                    pdu_bin_value += dec2bin(MSISDN_present_Ext_SN,1);
                    pdu_bin_value += dec2bin(Numbering_plan_identification,4);
                    pdu_bin_value += dec2bin(Type_of_number,3);
                    pdu_bin_value += dec2bin(Screening_indicator,2);
                }
                
                pdu_bin_value += dec2bin(ISISDS_subtype,1);
                if (ISISDS_subtype == "0")
                {    
                    pdu_bin_value += dec2bin(Pre_coded_status,16);            
                }
                else
                if (ISISDS_subtype == "1")
                {             
                    pdu_bin_value += dec2bin(Short_data_type_id,2);            
                    if (Short_data_type_id == "0")   
                    {
                        pdu_bin_value += dec2bin(User_defined_data_1_3,16);
                    }
                    else
                    if (Short_data_type_id == "1")   
                    {
                        pdu_bin_value += dec2bin(User_defined_data_1_3,32);
                    }
                    else
                    if (Short_data_type_id == "2")   
                    {
                        pdu_bin_value += dec2bin(User_defined_data_1_3,64);
                    }
                    else
                    if (Short_data_type_id == "3")   
                    {
                        SDS_4_Length_Indicator = /*11 + */8 + 4 + 2 + 1 + 1 + 8 + 1 + 7 + /*8 + */User_defined_data_4.length*8;   
                        SDS_4_Protocol_Id = 0x82;   /* Text Message */
                        SDS_4_Message_type = 0x00;   /* SDS-TRANSFER */
                        
                        SDS_4_Delivery_Report_Request = 0;
                        SDS_4_Service_Selection = 0;
                        SDS_4_Storage = 0;
                        SDS_4_Message_Reference = 123;
                        
                        SDS_4_TimeStamp_Used = 0;
                        
                        pdu_bin_value += dec2bin(SDS_4_Length_Indicator,11);
                        pdu_bin_value += dec2bin(SDS_4_Protocol_Id,8);
                        pdu_bin_value += dec2bin(SDS_4_Message_type,4);
                        
                        pdu_bin_value += dec2bin(SDS_4_Delivery_Report_Request,2);
                        pdu_bin_value += dec2bin(SDS_4_Service_Selection,1);
                        pdu_bin_value += dec2bin(SDS_4_Storage,1);
                        pdu_bin_value += dec2bin(SDS_4_Message_Reference,8);

                        pdu_bin_value += dec2bin(SDS_4_TimeStamp_Used,1);
                        
                        pdu_bin_value += dec2bin(8,7);
                        //pdu_bin_value += dec2bin(User_defined_data_4.length*8,8);
                        pdu_bin_value += text2bin(User_defined_data_4);
                        
                    }
                }

                pdu_bin_value += dec2bin(Hop_count,2);
                
                T2_pdu_bin_value += T2_Selected_area_number;
                if (T2_Selected_area_number != "0")
                {
                    T2_pdu_bin_value += dec2bin(Selected_area_number,8);
                }
                
                T2_str = T2_Selected_area_number
                T2 = parseInt(T2_str,2);                
                if (T2 > 0)
                    T2_pdu_bin_value = "1" + T2_pdu_bin_value;
                else
                    T2_pdu_bin_value = "0";
                    
                pdu_bin_value += T2_pdu_bin_value;
                
                return pdu_bin_value;
            }                            
            
            function OnChange_Calling_Party_Ext(form)
            {
                Calling_Party_Ext = document.getElementById('Calling_Party_Ext').value;      
                if (Calling_Party_Ext.length != 0)
                {
                    document.getElementById('MSISDN_present_Ext_SN').disabled = false;
                    document.getElementById('Numbering_plan_identification').disabled = false;
                    document.getElementById('Type_of_number').disabled = false;
                    document.getElementById('Screening_indicator').disabled = false;
                }
                else
                {
                    document.getElementById('MSISDN_present_Ext_SN').disabled = true;
                    document.getElementById('Numbering_plan_identification').disabled = true;
                    document.getElementById('Type_of_number').disabled = true;
                    document.getElementById('Screening_indicator').disabled = true;
                }
            }
            function OnChange_ISISDS_subtype(form)
            {
                ISISDS_subtype = document.getElementById('ISISDS_subtype').value;      
                if (ISISDS_subtype != "0")
                {
                    document.getElementById('Pre_coded_status').disabled = true;
                    document.getElementById('Short_data_type_id').disabled = false;
                }
                else
                {
                    document.getElementById('Pre_coded_status').disabled = false;
                    document.getElementById('Short_data_type_id').disabled = true;
                }
                OnChange_Short_data_type_id(form);
            }

            function OnChange_Short_data_type_id(form)
            {
                ISISDS_subtype = document.getElementById('ISISDS_subtype').value; 
                if (ISISDS_subtype == "0")
                {
                    document.getElementById('User_defined_data_1_3').disabled = true;
                    document.getElementById('User_defined_data_4').disabled = true;
                }
                else
                {
                    Short_data_type_id = document.getElementById('Short_data_type_id').value;      
                    if (Short_data_type_id == "3")
                    {
                        document.getElementById('User_defined_data_1_3').disabled = true;
                        document.getElementById('User_defined_data_4').disabled = false;
                    }
                    else
                    {
                        document.getElementById('User_defined_data_1_3').disabled = false;
                        document.getElementById('User_defined_data_4').disabled = true;
                    }
                }
            }
                                
        </script>
    </body>
</HTML>
